name: Update Last Active Time

on:
  schedule:
    - cron: '0 */6 * * *'  # 6ì‹œê°„ë§ˆë‹¤ ì‹¤í–‰
  workflow_dispatch:  # ìˆ˜ë™ ì‹¤í–‰ ê°€ëŠ¥

jobs:
  update-time:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v3
        
      - name: Set up timezone
        uses: szenius/set-timezone@v1.2
        with:
          timezoneLinux: "Asia/Seoul"
          
      - name: Update last active time
        run: |
          # í˜„ì¬ ì‹œê°„ ê°€ì ¸ì˜¤ê¸° (í•œêµ­ ì‹œê°„)
          CURRENT_TIME=$(date '+%Y-%m-%d %H:%M:%S KST')
          
          # README.md íŒŒì¼ì—ì„œ ë§ˆì§€ë§‰ í™œë™ ì‹œê°„ ì—…ë°ì´íŠ¸
          sed -i "s|<!--LAST_ACTIVE-->|${CURRENT_TIME}|g" README.md
          
          # ë³€ê²½ í™•ì¸
          if [[ -z $(git status --porcelain) ]]; then
            echo "No changes detected."
            exit 0
          fi
          
      - name: Commit and push changes
        run: |
          git config --local user.email "github-actions[bot]@users.noreply.github.com"
          git config --local user.name "github-actions[bot]"
          git commit -am "ğŸ¤– ìë™ ì—…ë°ì´íŠ¸: ë§ˆì§€ë§‰ í™œë™ ì‹œê°„"
          git push
